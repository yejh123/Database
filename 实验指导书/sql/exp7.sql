








PRIMARY KEY主键约束的建立
1)建立表时加主键约束
CREATE  TABLE  ST(SNO VARCHAR (10) PRIMARY KEY ,SNAME VARCHAR(20) NOT NULL, DEPT VARCHAR(20), AGE INT, SEX CHAR(4))
GO
INSERT  INTO  ST (SNO,SNAME,DEPT) VALUES('1001','ZXX',NULL)
GO
INSERT  INTO  ST (SNO,SNAME) VALUES('1001','MID')
GO  
INSERT  INTO   ST (SNO,SNAME) VALUES(NULL,'ZXX')


2)在已有的表上添加约束
CREATE  TABLE  ST2 (SNO VARCHAR (10)  NOT NULL ,SNAME VARCHAR(20) NOT NULL, DEPT VARCHAR(20), AGE INT, SEX CHAR(4))
GO
INSERT  INTO  ST2  SELECT  *  FROM  S
GO
ALTER  TABLE  ST2  ADD  CONSTRAINT priKEY  PRIMARY KEY (SNO)
INSERT  INTO  ST2  (SNO,SNAME,DEPT)  VALUES('200512','Beibei',NULL)
运行后出现什么结果？分析原因。


（2）DEFAULT约束
CREATE  TABLE  CUST(
	NO VARCHAR(5) PRIMARY KEY, 
	WEIGHT  INT  DEFAULT(10))
GO
INSERT INTO CUST(NO)  VALUES('ZY01')
INSERT INTO CUST(NO)  VALUES('ZY03')
INSERT  INTO  CUST  VALUES('ZY02',20) 
GO 
SELECT  *  FROM  CUST
运行后出现什么结果？分析原因。


（3）CHECK 约束
CREATE  TABLE  CUSTOMER(
	CUSTNO  CHAR(4)  NOT NULL CHECK (CUSTNO LIKE '[A-Z0-9] [A-Z0-9] [A-Z0-9] [A-Z0-9]'),
	CUSTNAME VARCHAR(20))
GO
INSERT  INTO  CUSTOMER VALUES('BJ01','Beijing Grid Corp.')
GO
INSERT  INTO  CUSTOMER VALUES('BJ1','Beijing Grid Corp.')
GO
INSERT  INTO  CUSTOMER VALUES('BJ*1','Beijing Grid Corp.')
运行后出现什么结果？分析原因。


（4）UNIQUE 唯一性约束的建立
CREATE  TABLE  CUST1(
	CUSTNO  CHAR(4)PRIMARY KEY,
	CUSTNAME VARCHAR(20) UNIQUE,
	COUNTRY  VARCHAR(10))
GO 
INSERT  INTO  CUST1(CUSTNO) VALUES('BJ01')
GO
INSERT  INTO  CUST1(CUSTNO) VALUES ('BJ02')
GO
INSERT  INTO  CUST1 VALUES ('BJ03','Beijing Grid Corp.')
GO
INSERT  INTO  CUST1 VALUES ('BJ04','Beijing Grid Corp.')
运行后出现什么结果？分析原因。


（5）FOREIGN KEY外键约束的建立
先创建如下数据表：
Create table S (SNO VARCHAR (10) NOT NULL ,SNAME VARCHAR(20),DEPT VARCHAR(20), AGE INT, SEX CHAR(4) )
Create table C (CNO VARCHAR(10) NOT NULL, CNAME VARCHAR(20),cpno varchar(10),credit int)
Create table SC(SNO VARCHAR(10) NOT NULL, CNO VARCHAR(10) NOT NULL, SCORE DECIMAL)
然后执行如下语句：
ALTER  TABLE  C  ADD  CONSTRAINT  CpriKEY  PRIMARY KEY(CNO)
GO
ALTER TABLE  SC  ADD CONSTRAINT  scpriKEY  PRIMARY  KEY(SNO,CNO)
ALTER TABLE  SC  ADD CONSTRAINT  scforKEY1  FOREIGN  KEY (SNO) REFERENCES  ST2(SNO)
ALTER TABLE  SC  ADD CONSTRAINT  scforKEY2  FOREIGN  KEY (CNO) REFERENCES  C(CNO)
GO
INSERT  INTO  SC (SNO,CNO) VALUES('890','C10')
INSERT  INTO  SC (SNO,CNO) VALUES('200518','C01')
INSERT  INTO  SC (SNO,CNO) VALUES('890',NULL)
INSERT  INTO  SC (SNO,CNO) VALUES(NULL,'C10')
运行后出现什么结果？分析原因。


设计性实验
1)在S表中添加完整性约束：SNO设置为主键，SEX 的却省值为‘女’,AGE 的有效值为16-25。
ALTER TABLE S ADD CONSTRAINT PK_SNO PRIMARY KEY(SNO)
GO
ALTER TABLE S ADD CONSTRAINT DF_SEX DEFAULT('女') FOR SEX;
GO
ALTER TABLE S ADD CONSTRAINT CK_AGE CHECK (AGE BETWEEN 16 AND 25)


2)创建1张与S相同的表S1，在创建的同时将SNO设置为主键，SEX 的却省值为‘女’,AGE 的有效值为16-25 ，
并将S表中的数据插入到S1中，插入不同的记录来严整设置的完整性。
create table S1 (
	SNO VARCHAR (10) PRIMARY KEY ,
	SNAME VARCHAR(20),
	DEPT VARCHAR(20), 
	AGE INT CHECK(AGE BETWEEN 16 AND 25), 
	SEX CHAR(4) DEFAULT('女')
)
GO
INSERT INTO S1 SELECT * FROM S
GO
SELECT * FROM S1


3)创建1张与SC相同的表SC1，将（SNO，CNO）设置为主键，SNO和CNO设置为外键，并将SC表中的数据复制到SC1中，
插入不同的记录来严整设置的完整性。
create table SC1(
	SNO VARCHAR(10) NOT NULL,
	CNO VARCHAR(10) NOT NULL,
	SCORE DECIMAL,
	CONSTRAINT  PK_SNO_CNO PRIMARY KEY(SNO,CNO),
	CONSTRAINT  FK_SNO FOREIGN KEY(SNO) REFERENCES S(SNO),
	CONSTRAINT  FK_CNO FOREIGN KEY(CNO) REFERENCES C(CNO)
)
GO
INSERT INTO SC1 SELECT * FROM SC
SELECT * FROM SC1

DROP TABLE SC;
create table SC(
	SNO VARCHAR(10) NOT NULL,
	CNO VARCHAR(10) NOT NULL,
	SCORE DECIMAL
);
GO
DELETE FROM SC
GO
INSERT INTO SC VALUES
('200512','c02',70),
('200512','c03',null),
('200512','c04',null),
('200515','c01',80),
('200518','c03',95),
('200018','c01',80),
('200518','c02',45),
('200511','c02',78),
('200511','c01',45),
('200511','c03',89),
('200514','c02',78),
('200514','c01',45),
('200514','c03',89),
('200514','c04',78);

DELETE FROM C1
GO
INSERT INTO C1 VALUES
('c01','数据库原理','c03','4'),
('c02','信息系统','c01','4'),
('c03','数据结构',null,'6'),
('c04','DB_设计','c01','3')


4)创建1张与C表相同的表C1，将C中数据插入到C1后，在C1上添加完整性约束：将（CNO）设置为主键，CPNO 引用 CNO，CREDIT值为1-6。
create table C1 (
	CNO VARCHAR(10) NOT NULL,
	CNAME VARCHAR(20),
	cpno varchar(10),
	credit int
)
GO
INSERT INTO C1 SELECT * FROM C
GO
ALTER TABLE C1 ADD CONSTRAINT PK_CNO PRIMARY KEY(CNO)
GO
ALTER TABLE C1 ADD CONSTRAINT FK_CNO FOREIGN KEY(CPNO) REFERENCES C1(CNO)
GO 
ALTER TABLE C1 ADD CONSTRAINT CK_CREDIT CHECK(CREDIT BETWEEN 1 AND 6)
GO
SELECT * FROM C1

CREATE CLUSTERED INDEX CISNO ON S(SNO)